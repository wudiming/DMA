# 更新日志

## [1.0.3] - 2025-12-16

### 修复
- **自我更新**: 修复了自我更新脚本因镜像 Entrypoint 导致无法执行的问题。现在显式设置 `Entrypoint` 为 `sh -c`。
- **界面优化**: 优化了容器操作菜单的定位逻辑，改为基于按钮位置的确定性判断，彻底解决菜单跳动问题。

## [1.0.2] - 2025-12-16

### 修复
- **自我更新**: 修复了 DMA 远程自我更新时可能无法下载最新镜像的问题。现在更新脚本会强制拉取最新镜像。
- **界面优化**: 修复了容器列表底部的操作菜单会被遮挡的问题。菜单现在会根据屏幕空间自动调整显示方向（向上或向下）。

## [1.0.1] - 2025-12-14

### 新增功能
- **用户模板**:
    - 新增删除用户模板的功能（包含确认对话框）。
    - 重建或编辑容器时，自动保存/更新对应的用户模板。
    - 导入外部堆栈配置时，自动将其保存为模板。
- **本地化**: 补充了缺失的中文翻译 "确认删除" (`confirm_delete`)。

### 变更优化
- **排序优化**:
    - 容器列表现在默认按名称（A-Z）字母顺序排列。
    - 堆栈列表现在默认按名称（A-Z）字母顺序排列。
- **容器管理**:
    - 将图标下载逻辑从 `https` 替换为 `fetch`，以正确处理 HTTP 302 重定向。
    - 优化了容器操作菜单的交互体验：点击操作（如打开 Web UI、启动、停止等）后，菜单会自动关闭。
- **导航修复**:
    - 修复了更新堆栈容器时错误跳转到“模板库”的问题，现在会正确跳转到“已部署堆栈”标签页。

### 性能优化
- **Agent 模式**:
    - 优化了 Agent 模式的内存占用。
    - 实现了 `agent.js` 和 `manager.js` 的动态导入，确保 Agent 模式下不再加载不必要的 Manager 依赖。

### 问题修复
- 修复了 GitHub raw 链接的图标无法下载的问题。
- 修复了点击“打开网页界面”后容器操作菜单不会自动关闭的问题。
- **堆栈管理**:
    - 修复了导入现有堆栈配置时会创建重复堆栈的问题，现在会正确更新现有堆栈。
    - 修复了从模板部署堆栈时，内部ID映射错误导致无法删除或产生重复的问题。
- **镜像管理**:
    - 新增智能镜像备份功能：更新容器前会自动备份旧镜像。系统会优先尝试提取版本号（如 `3.2`）作为标签，若无法提取则使用时间戳，防止旧镜像丢失。
- **本地化**:
    - 修复了模板库中“自定义”分类、“已导入”标签和“从堆栈导入”描述缺失中文翻译的问题。
    - 修复了中文语言包 (`zh.json`) 的语法错误导致应用无法启动的问题。
